---
layout: default
---

# [Train transformer](https://www.tensorflow.org/text/tutorials/transformer)

```python
# apt install --allow-change-held-packages libcudnn8=8.1.0.77-1+cuda11.2
# pip uninstall -y -q tensorflow keras tensorflow-estimator tensorflow-text
# pip install protobuf~=3.20.3
# pip install -q tensorflow_datasets
!pip install -q -U tensorflow-text tensorflow
```

```python
import time
import logging
import numpy as np
import matplotlib.pyplot as plt

import tensorflow_text
import tensorflow as tf
import tensorflow_datasets as tfds
```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```

```python

```